import{_ as k}from"./InputSelect.vue_vue_type_script_setup_true_lang-Cf5gD1vr.js";import{d as N,r as C,B as $,q as u,x as B,c as n,o as r,b as i,j as _,i as f,t as c,F as S,h as V,a as y,u as a,w as b,e as v}from"./app-CqEa0Bzm.js";import{a as z}from"./helpers-DgrGhv05.js";import{_ as g}from"./index-DJ1xocaX.js";import{R as U}from"./rocket-BuwlBC64.js";const j={class:"mb-4 border-t border-gray-100 pt-4"},D={class:"mb-3 flex items-center justify-between"},F={key:0,class:"space-y-2"},T={class:"text-gray-600"},q={class:"font-semibold text-primary"},E={key:1,class:"relative"},G=N({__name:"PromoteNow",props:{promotable:{},plans:{},promotableType:{}},setup(w){const l=w,p=C(!1),h=$(),m=u(()=>h.props.auth.user),o=B({plan_id:null,promotable_id:l.promotable.id,promotable_type:l.promotableType}),d=u(()=>{const t=l.plans.find(e=>e.id===o.plan_id);return t?t.price<m.value.points_in_cedis:!1}),x=()=>{o.post(route("promotions.payment.initialize"),{replace:!0,onSuccess:t=>{const e=t.props.data.authorization_url;e?window.location=e:z("Payment initialization failed, pleased reload the page and try again")}})},P=()=>{d.value&&o.post(route("promotions.payment.points"),{onSuccess:t=>{console.log(t.props)}})};return(t,e)=>(r(),n("div",j,[i("div",D,[e[1]||(e[1]=i("h4",{class:"font-semibold text-gray-900"},"Promote Now",-1)),i("button",{onClick:e[0]||(e[0]=s=>p.value=!p.value),class:"text-sm font-medium text-primary transition-colors hover:text-primary/80"},c(p.value?"Select Plan":"View Plans"),1)]),p.value?(r(),n("div",F,[(r(!0),n(S,null,V(l.plans.slice(0,3),s=>(r(),n("div",{key:s.id,class:"flex items-center justify-between text-sm"},[i("span",T,c(s.number_of_days)+" Days",1),i("span",q,c(s.price),1)]))),128))])):(r(),n("div",E,[y(k,{label:"Select Plan",form:a(o),model:"plan_id",options:t.plans.map(s=>({label:`${s.name} - ${s.number_of_days} Days - â‚µ${s.price}`,value:s.id})),required:"",searchable:""},null,8,["form","options"])])),a(o).plan_id?(r(),_(a(g),{key:2,onClick:P,processing:a(o).processing,class:"mt-4 w-full",variant:"secondary",disabled:!d.value},{default:b(()=>[v(" Use My Points ("+c(m.value.points)+" points) ",1)]),_:1},8,["processing","disabled"])):f("",!0),a(o).plan_id?(r(),_(a(g),{key:3,onClick:x,processing:a(o).processing,class:"mt-4 w-full"},{default:b(()=>[y(a(U),{class:"h-4 w-4"}),e[2]||(e[2]=v(" Promote Now "))]),_:1,__:[2]},8,["processing"])):f("",!0)]))}});export{G as _};
