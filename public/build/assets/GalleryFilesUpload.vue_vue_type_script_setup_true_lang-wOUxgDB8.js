import{P as b}from"./plus-B-jqb12W.js";import{X as p}from"./InputText.vue_vue_type_script_setup_true_lang-Bx_W_oI_.js";import{d as U,b4 as L,bE as R,r as E,s as I,I as j,c as o,o as a,b as t,a as d,u as c,t as u,i as m,F as h,h as v}from"./app-DSuh8Bw5.js";const C={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},N={class:"flex items-center justify-between mb-4"},O={class:"flex items-center space-x-3"},G={class:"p-2 bg-primary rounded-lg"},$={class:"inline-flex items-center whitespace-nowrap px-3 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded-full"},F={class:"space-y-4"},M={class:"relative rounded-lg border-2 border-dashed border-gray-300 p-4 transition-all duration-200 hover:border-primary hover:bg-indigo-50/50 group"},P={class:"text-center"},W={key:0,class:"max-h-96 overflow-y-auto"},B={class:"grid grid-cols-2 gap-3 pr-2"},V={key:0,class:"relative group"},A=["src","alt"],T=["onClick"],D={class:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-blue-500/80 rounded text-white text-xs"},K=["src","alt"],S=["onClick"],X={class:"absolute bottom-1 left-1 px-1.5 py-0.5 bg-green-500/80 rounded text-white text-xs"},q={key:1,class:"text-center py-8 text-gray-500"},z={class:"text-xs mt-1"},H={key:2,class:"space-y-1"},J={key:0,class:"text-sm text-red-600 flex items-center space-x-1"},Q={key:1,class:"text-sm text-red-600 flex items-center space-x-1"},re=U({__name:"GalleryFilesUpload",props:L({form:{},galleryItems:{default:()=>[]},galleryErrors:{default:()=>[]}},{files:{default:()=>[]},filesModifiers:{}}),emits:["update:files"],setup(f,{expose:_}){const y=f,n=R(f,"files"),i=E([]);_({resetGallery:()=>{i.value.forEach(e=>{e.startsWith("blob:")&&URL.revokeObjectURL(e)}),n.value=[],i.value=[]}}),I(n,e=>{const s=e.length;for(;i.value.length>s;){const r=i.value.pop();r&&r.startsWith("blob:")&&URL.revokeObjectURL(r)}for(let r=i.value.length;r<e.length;r++)i.value.push(URL.createObjectURL(e[r]))},{deep:!0});const w=e=>{const s=e.target,r=Array.from(s.files||[]);if(r.length>0){const l=[...n.value];r.forEach(g=>{l.push(g)}),n.value=l}s.value=""},x=e=>{const s=i.value[e];s&&s.startsWith("blob:")&&URL.revokeObjectURL(s);const r=[...n.value],l=[...i.value];r.splice(e,1),l.splice(e,1),n.value=r,i.value=l},k=e=>{const s=y.galleryItems[e];s&&s.isOriginal&&(y.form.removed_gallery_urls.includes(s.url)||y.form.removed_gallery_urls.push(s.url))};return j(()=>{i.value.forEach(e=>{e.startsWith("blob:")&&URL.revokeObjectURL(e)})}),(e,s)=>(a(),o("div",C,[t("div",N,[t("div",O,[t("div",G,[d(c(b),{class:"h-5 w-5 text-white"})]),s[0]||(s[0]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Gallery Images",-1))]),t("span",$,u(e.galleryItems.filter(r=>{var l;return!((l=e.form.removed_gallery_urls)!=null&&l.includes(r.url))}).length+n.value.length)+" images ",1)]),t("div",F,[t("div",M,[t("input",{type:"file",multiple:"",accept:"image/*",onChange:w,class:"absolute inset-0 h-full w-full cursor-pointer opacity-0"},null,32),t("div",P,[d(c(b),{class:"mx-auto h-8 w-8 text-gray-400 group-hover:text-primary transition-colors duration-200"}),s[1]||(s[1]=t("p",{class:"text-sm font-medium text-gray-700 mt-2"},"Add more images",-1)),s[2]||(s[2]=t("p",{class:"text-xs text-gray-500"},"Multiple selection supported",-1))])]),e.galleryItems.length||n.value.length?(a(),o("div",W,[t("div",B,[(a(!0),o(h,null,v(e.galleryItems,(r,l)=>{var g;return a(),o(h,{key:`original-${l}`},[(g=e.form.removed_gallery_urls)!=null&&g.includes(r.url)?m("",!0):(a(),o("div",V,[t("img",{src:r.url,alt:`Gallery image ${l+1}`,class:"w-full h-24 rounded-lg object-cover border border-gray-200"},null,8,A),t("button",{type:"button",onClick:Z=>k(l),class:"absolute top-1 right-1 p-1 bg-red-100 hover:bg-red-200 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-200"},[d(c(p),{class:"h-3 w-3 text-red-600"})],8,T),t("div",D," Existing "+u(l+1),1)]))],64)}),128)),(a(!0),o(h,null,v(i.value,(r,l)=>(a(),o("div",{key:`new-${l}`,class:"relative group"},[t("img",{src:r,alt:`New image ${l+1}`,class:"w-full h-24 rounded-lg object-cover border border-gray-200"},null,8,K),t("button",{type:"button",onClick:g=>x(l),class:"absolute top-1 right-1 p-1 bg-red-100 hover:bg-red-200 rounded-full shadow-lg opacity-0 group-hover:opacity-100 transition-all duration-200"},[d(c(p),{class:"h-3 w-3 text-red-600"})],8,S),t("div",X," New "+u(l+1),1)]))),128))])])):(a(),o("div",q,[s[3]||(s[3]=t("p",null,"No images to display",-1)),t("p",z,"Gallery items: "+u(e.galleryItems.length)+", New uploads: "+u(n.value.length),1)])),e.form.errors.gallery_images||e.form.errors.gallery||e.galleryErrors.length?(a(),o("div",H,[e.form.errors.gallery_images?(a(),o("p",J,[d(c(p),{class:"h-4 w-4"}),t("span",null,u(e.form.errors.gallery_images),1)])):m("",!0),e.form.errors.gallery?(a(),o("p",Q,[d(c(p),{class:"h-4 w-4"}),t("span",null,u(e.form.errors.gallery),1)])):m("",!0),(a(!0),o(h,null,v(e.galleryErrors,(r,l)=>(a(),o("p",{key:l,class:"text-sm text-red-600 flex items-center space-x-1"},[d(c(p),{class:"h-4 w-4"}),t("span",null,u(r),1)]))),128))])):m("",!0)])]))}});export{re as _};
